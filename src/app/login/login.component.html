<form #loginForm="ngForm" (ngSubmit)="login(loginForm)" novalidate>
  <div class="container py-4">
    <div class="row g-4 align-items-stretch">

      <!-- Left: Login Card -->
      <div class="col-12 col-lg-7">
        <div class="auth-card shadow-sm rounded-4 p-4 p-lg-5">

          <div class="d-flex align-items-center gap-2 mb-4">
            <img src="/assets/challenge_tavern_logo_camo.jpg" alt="Challenge Tavern" width="56" height="44" class="rounded">
            <h1 class="h4 mb-0">Welcome back</h1>
          </div>

          <!-- Optional server/auth error -->
          @if ( authError){
            <div class="alert alert-danger py-2" role="alert">
            {{ authError }}
          </div>
        }
          <!-- Username / Email -->
          <div class="mt-2">
            <label class="form-label" for="username">Username or email</label>
            <input
              id="username"
              name="username"
              type="text"
              class="form-control"
              placeholder="you@example.com"
              ngModel
              required
              #usernameCtrl="ngModel">
            @if (usernameCtrl.touched && usernameCtrl.invalid){
            <div class="invalid-msg" >
              Username is required.
            </div>
              }
          </div>

          <!-- Password -->
          <div class="mt-3">
            <label class="form-label" for="password">Password</label>
            <div class="input-group">
              <input
                id="password"
                name="password"
                [type]="showPw ? 'text' : 'password'"
                class="form-control"
                placeholder="Your password"
                ngModel
                required
                minlength="8"
                #passwordCtrl="ngModel">
              <button
                type="button"
                class="btn btn-outline-secondary"
                (click)="showPw = !showPw"
                aria-label="Toggle password visibility">
                {{ showPw ? 'Hide' : 'Show' }}
              </button>
            </div>
            @if (passwordCtrl.touched && passwordCtrl.errors?.['required']){
            <div class="invalid-msg" >
              Password is required.
            </div>
              }
           @if(passwordCtrl.touched && passwordCtrl.errors?.['minlength']){
            <div class="invalid-msg" >
              At least 8 characters.
            </div>
             }
          </div>

          <!-- Remember + Links -->
          <div class="d-flex justify-content-between align-items-center mt-3">
            <div class="form-check">
              <input id="remember" name="remember" type="checkbox" class="form-check-input" ngModel>
              <label for="remember" class="form-check-label">Remember me</label>
            </div>
            <a class="small text-decoration-none" routerLink="/forgot-password">Forgot password?</a>
          </div>

          <!-- Submit -->
          <div class="d-grid mt-4">
            <button class="btn btn-primary btn-lg" type="submit" [disabled]="loginForm.invalid || loading">
              {{ loading ? 'Signing in…' : 'Login' }}
            </button>
          </div>

          <!-- Divider + CTA -->
          <div class="text-center mt-4">
            <span class="text-muted small">Don’t have an account?</span>
            <a class="small ms-1" routerLink="/sign-up">Create account</a>
          </div>
        </div>
      </div>

      <!-- Right: Visual Panel -->
      <div class="col-12 col-lg-5">
        <div class="visual-card rounded-4 overflow-hidden h-100">
          <img class="w-100 h-100 object-fit-cover" src="assets/las_pulgas_background.jpg" alt="Las Pulgas">
          <div class="visual-overlay p-4 p-lg-5">
            <h2 class="h4 text-white mb-2">Log in to compete</h2>
            <p class="text-white-50 mb-0">Track workouts. Earn badges. Top the leaderboard.</p>
          </div>
        </div>
      </div>

    </div>
  </div>
</form>
